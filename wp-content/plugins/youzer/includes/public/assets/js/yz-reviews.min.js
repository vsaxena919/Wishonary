!function(s){"use strict";s(document).ready(function(){var i;s(document).on("click","#yz-add-review",function(e){e.preventDefault();var t=s("#yz-review-form").serialize()+"&action=yz_handle_user_reviews&operation="+s(this).attr("data-action")+"&security="+Youzer.security_nonce,o=s(this);o.text();o.attr("disabled","disabled"),o.addClass("loading"),s.post(ajaxurl,t,function(e){o.removeClass("loading");var t=s.parseJSON(e);return t.error?(s.yz_DialogMsg("error",t.error),o.attr("disabled",!1)):(o.closest(".yz-modal").fadeOut(300,function(){s(this).remove()}),"yz-item-tools"!=i.parent().attr("class")&&i.find(".yz-tool-name").text(Yz_Reviews.edit_review),"edit"==t.action?(i.attr("data-review-id",t.review_id),i.attr("data-action","edit"),i.find(".yz-tool-name").text(t.button_title),i.find(".yz-tool-icon i").removeClass().addClass("fas fa-edit"),void 0!==i.attr("data-yztooltip")&&i.attr("data-yztooltip",t.button_title)):"delete_button"==t.action&&i.remove(),s.yz_DialogMsg("success",t.msg),s(".yz-modal-overlay").fadeOut()),!1}).fail(function(e,t,a){return o.attr("disabled","disabled"),s.yz_DialogMsg("error",Youzer.unknown_error),!1})}),s(document).on("click",".yz-review-btn, .yz-review-tool.yz-edit-tool",function(e){e.preventDefault(),i=s(this);var t,o=s(this),a=null;if(i.hasClass("yz-review-btn")?(a=s(this).attr("data-review-id"),t=s(this).parent(".yz-tools").data("user-id")):(a=s(this).parent(".yz-item-tools").data("review-id"),t=s(this).parent(".yz-item-tools").data("user-id")),s(this).hasClass("loading"))return!1;o.addClass("loading");var r={user_id:t,review_id:a,security:Youzer.security_nonce,action:"yz_get_user_review_form",operation:s(this).attr("data-action")};s.post(Youzer.ajax_url,r,function(e){if(s.yz_isJSON(e)){var t=s.parseJSON(e);return o.removeClass("loading"),s.yz_DialogMsg("error",t.error),!1}o.attr("data-loaded","true"),o.removeClass("loading");var a=s(e);s("body").append(a),a.find(".yz-modal").css({position:"absolute",top:s(document).scrollTop()+100}),s(".yz-modal-overlay")[0]?s(".yz-modal-overlay").fadeIn():s("body").append('<div class="yz-modal-overlay"></div>')}).fail(function(e,t,a){return o.removeClass("loading"),s.yz_DialogMsg("error",Youzer.unknown_error),!1})}),s(document).on("click","#yz-delete-review, .yz-review-tool.yz-delete-tool",function(e){e.preventDefault();var t,a=s(this);a.text();a.attr("disabled","disabled"),a.addClass("loading");var o=new FormData;t=a.hasClass("yz-delete-tool")?s(this).parent(".yz-item-tools").data("review-id"):a.closest(".yz-modal").find('input[name="review_id"]').val(),o.append("review_id",t),o.append("action","yz_delete_user_review"),o.append("security",Youzer.security_nonce),s.ajax({type:"POST",data:o,url:Youzer.ajax_url,contentType:!1,processData:!1,success:function(e){a.removeClass("loading"),a.attr("disabled",!1);var t=s.parseJSON(e);return t.error?(s.yz_DialogMsg("error",t.error),a.attr("disabled",!1)):(a.hasClass("yz-delete-tool")?a.closest(".yz-review-item").fadeOut(300,function(){s(this).remove()}):(a.closest(".yz-modal").fadeOut(300,function(){s(this).remove()}),i.find(".yz-tool-name").text(Yz_Reviews.edit_review),i.remove()),s.yz_DialogMsg("success",t.msg),s(".yz-modal-overlay").fadeOut()),!1}})})})}(jQuery);