!function(o){"use strict";o(document).ready(function(){o.YZLP={};var r=/((https?|ftp)\:\/\/)?([a-z0-9+!*(),;?&=\$_.-]+(\:[a-z0-9+!*(),;?&=\$_.-]+)?@)?([a-z0-9-.]*)\.([a-z]{2,3})(\:[0-9]{2,5})?(\/([a-z0-9+\$_\-~@\(\)\%]\.?)+)*\/?(\?[a-z+&\$_.-][a-z0-9;:@&#%=+\/\$_.-]*)?(#[a-z_.-][a-z0-9+\$_.-]*)?/i,l=/(https?:\/\/(?:www\.|(?!www))[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9]\.[^\s]{2,}|www\.[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9]\.[^\s]{2,}|https?:\/\/(?:www\.|(?!www))[a-zA-Z0-9]+\.[^\s]{2,}|www\.[a-zA-Z0-9]+\.[^\s]{2,})/gi,e=(Youzer.youzer_url,o("#yz-wall-form").find(".lp-prepost-container").html());o(document).on("paste",".yz-wall-textarea",function(e){o.yz_get_link_preview_data(o(this).closest("form"),o(this).val())}),o(document).on("keyup",".yz-wall-textarea",function(e){13!=e.which&&32!=e.which&&17!=e.which||o.yz_get_link_preview_data(o(this).closest("form"),o(this).val())}),o(document).on("keyup",".emojionearea-editor",function(e){o.yz_get_link_preview_data(o(this).closest("form"),o(this).text())}),o(document).on("change",".lp-preview-no-thubmnail-text input",function(){var e=o(this).closest(".lp-prepost-container");this.checked?e.find(".lp-preview-image").fadeOut(200,function(){e.addClass("yz-lp-no-thumbnail")}):e.find(".lp-preview-image").fadeIn(200,function(){e.removeClass("yz-lp-no-thumbnail")})}),o(document).on("click",".lp-button-cancel",function(){o(this).closest(".yz-lp-prepost").attr("data-loaded",!1),o(this).closest(".lp-prepost-container").fadeOut(200,function(){o(this).html(e).attr("class","lp-prepost-container")})}),o(document).on("click",".lp-preview-title",function(){o(this).fadeOut(200,function(){o(this).closest(".yz-lp-prepost").find(".lp-preview-replace-title").fadeIn()})}),o(document).on("click",".lp-preview-description",function(){o(this).fadeOut(200,function(){o(this).closest(".yz-lp-prepost").find(".lp-preview-replace-description").fadeIn()})}),o(document).on("click",".yz-lp-previous-image",function(){var e=parseInt(o(this).closest(".lp-preview-thubmnail-buttons").attr("data-current"));e<1||o.yz_update_live_preview_image(o(this).closest(".yz-lp-prepost"),e-1)}),o(document).on("click",".yz-lp-next-image",function(){var e=parseInt(o(this).closest(".lp-preview-thubmnail-buttons").attr("data-current"))+1;o.YZLP.images[e]&&o.yz_update_live_preview_image(o(this).closest(".yz-lp-prepost"),e)}),o.yz_update_live_preview_image=function(e,t){e.find('input[name="url_preview_img"]').val(o.YZLP.images[t]),e.find(".lp-preview-image").css("background-image","url("+o.YZLP.images[t]+")"),e.find(".lp-preview-thubmnail-buttons").attr("data-current",t),e.find(".lp-preview-pagination").find(".lp-preview-thubmnail-pagination").text(t+1)},o.yz_get_link_preview_data=function(t,e){if("activity_comment"!=t.find('input[name="post_type"]').val()&&"true"!=t.find(".yz-lp-prepost").attr("data-loaded")&&""!=e&&(i=e,r.test(i))){var i,a=e.match(r);if(n=a[0],l.test(n)){var n;t.find(".yz-wall-post, .yz-update-post").attr("disabled",!0),t.find(".lp-loading-text").fadeIn(),t.find(".yz-lp-prepost").attr("data-loaded",!0);var p=JSON.stringify({text:e,imageAmount:-1});o.ajax({url:ajaxurl,method:"POST",data:"action=yz_get_url_live_preview&data="+window.btoa(encodeURIComponent(p)),headers:{"Content-Type":"application/x-www-form-urlencoded"},success:function(e){e=o.parseJSON(e),o.yz_set_live_preview_form(t.find(".yz-lp-prepost"),e),t.find(".yz-wall-post, .yz-update-post").attr("disabled",!1)}})}}}}),o.yz_set_live_preview_form=function(e,t){var n=e.find(".lp-prepost-container"),i={"{{preview.title}}":t.title,"{{preview.site}}":t.site,"{{preview.description}}":t.description,"{{preview.image}}":t.image,"{{thumbnailPaginationText}}":1,"{{thumbnailText}}":t.images?t.images.length:1};o.YZLP.images=t.images,t.image&&e.find(".lp-preview-image").css("background-image","url("+t.image+")").prepend('<input type="hidden" name="url_preview_img" value="'+t.image+'">'),t.link&&e.find(".lp-preview-image").prepend('<input type="hidden" name="url_preview_link" value="'+t.link+'">'),t.site&&e.find(".lp-preview-image").prepend('<input type="hidden" name="url_preview_site" value="'+t.site+'">'),t.title&&e.find(".lp-preview-replace-title-wrap").append('<input type="text" class="lp-preview-replace-title" name="url_preview_title" value="'+t.title+'">'),t.description&&e.find(".lp-preview-replace-description-wrap").append('<textarea name="url_preview_desc" class="lp-no-resize lp-preview-replace-description">'+t.description+"</textarea>"),t.images&&t.images.length<2?n.find(".lp-preview-pagination").remove():n.find(".lp-preview-thubmnail-buttons").attr("data-current",0),0==t.video&&n.find(".lp-preview-video-icon").remove(),o.each(i,function(e,t){var i=new RegExp(e,"g"),a=n.html().replace(i,t);n.html(a)}),t.use_thumbnail&&"on"==t.use_thumbnail&&n.find('input[name="url_preview_use_thumbnail"]').attr("checked",!0).trigger("change"),e.find(".lp-loading-text").fadeOut(200,function(){n.fadeIn()})}}(jQuery);